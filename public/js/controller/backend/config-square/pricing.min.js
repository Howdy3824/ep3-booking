(function(){$(document).ready(function(){$("#pricing-table").on("click",".pricing-date-range-new",function(f){f.preventDefault();var e=$("#pricing-table-template").html();$(this).closest("table").find("tr:last").before("<tr><td>"+e+"</td></tr>");$(this).closest("table").find("tr:last").siblings("tr:last").hide().fadeIn();$(".datepicker").datepicker()});$("#pricing-table").on("click",".pricing-day-range-new",function(f){f.preventDefault();var e=$("#pricing-table-template").find(".pricing-day-range").closest("table").closest("td").html();$(this).closest("table").find("tr:last").before("<tr><td>"+e+"</td></tr>");$(this).closest("table").find("tr:last").siblings("tr:last").hide().fadeIn()});$("#pricing-table").on("click",".pricing-time-range-new",function(f){f.preventDefault();var e=$("#pricing-table-template").find(".pricing-time-range").closest("tr").closest("td").html();$(this).closest("table").find("tr:last").before("<tr><td>"+e+"</td></tr>");$(this).closest("table").find("tr:last").siblings("tr:last").hide().fadeIn()});$("#pricing-table").on("click",".pricing-price-new",function(f){f.preventDefault();var e=$("#pricing-table-template").find(".pricing-price").closest("tr").html();$(this).closest("table").find("tr:last").before("<tr>"+e+"</tr>");$(this).closest("table").find("tr:last").siblings("tr:last").hide().fadeIn();$(".tooltip").tooltip()});$("#pricing-table").on("click",".pricing-delete",function(f){f.preventDefault();var e=200;if($(this).closest("tbody").children("tr").length>2){$(this).closest("tr").fadeOut(e,function(){$(this).remove()})}else{if($(this).parents("tbody:eq(2)").children("tr").length>2){$(this).parents("tr:eq(2)").fadeOut(e,function(){$(this).remove()})}else{if($(this).parents("tbody:eq(4)").children("tr").length>2){$(this).parents("tr:eq(4)").fadeOut(e,function(){$(this).remove()})}else{$(this).parents("tr:eq(6)").fadeOut(e,function(){$(this).remove()})}}}});$("#pricing-save").on("click",function(f){$("#pricing-form-rules input").remove();var e=0;$("#pricing-table .pricing-price").each(function(l,g){var q=$(g);var k=q.parents("tbody:eq(1)").find(".pricing-time-range");var t=k.parents("tbody:eq(2)").find(".pricing-day-range");var r=t.parents("tbody:eq(2)").find(".pricing-date-range");var m=r.find("input.datepicker:first").val();var x=r.find("input.datepicker:last").val();var n=t.find("select:first").val();var o=t.find("select:last").val();var y=k.find("input.timepicker:first").val();var i=k.find("input.timepicker:last").val();var s=q.find("input.pricepicker").val();var p=q.find("select.pricing-rate-gross").val();var w=q.find("input.pricing-rate").val();var u=l;var j=q.find("select:last").val();var h=q.find("input.timeblockpicker").val();if(!m.match(/^(0[1-9]|[1-2][0-9]|3[0-1])\.(0[1-9]|1[0-2])\.[0-9]{4}$/)){window.alert('Hinweis: Das Datum "'+m+'" ist ungültig - Format: 24.12.2014');f.preventDefault();return}if(!x.match(/^(0[1-9]|[1-2][0-9]|3[0-1])\.(0[1-9]|1[0-2])\.[0-9]{4}$/)){window.alert('Hinweis: Das Datum "'+x+'" ist ungültig - Format: 24.12.2014');f.preventDefault();return}if(y.match(/^[0-9]{0,1}[0-9]$/)){y+=":00"}if(!y.match(/^[0-9]{0,1}[0-9]:[0-9][0-9]$/)){window.alert('Hinweis: Die Uhrzeit "'+y+'" ist ungültig - Format: 23:15');f.preventDefault();return}if(i.match(/^[0-9]{0,1}[0-9]$/)){i+=":00"}if(!i.match(/^[0-9]{0,1}[0-9]:[0-9][0-9]$/)){window.alert('Hinweis: Die Uhrzeit "'+i+'" ist ungültig - Format: 23:15');f.preventDefault();return}if(s.match(/^[0-9]+$/)){s+=",00"}if(!s.match(/^[0-9]+,[0-9][0-9]$/)){window.alert('Hinweis: Der Preis "'+s+'" ist ungültig - Format: 19,95');f.preventDefault();return}if(!h.match(/^[1-9][0-9]*$/)){window.alert('Hinweis: Die Minutenangabe "'+h+'" ist ungültig');f.preventDefault();return}var v=JSON.stringify([j,u,m,x,n,o,y,i,s,w,p,h]);$("#pricing-form-rules").append('<input type="hidden" name="pricing-rule-'+l+'" value="'+encodeURI(v)+'">');e++});$("#pricing-rules-count").val(e)});var d=window.pricingRules;var b;var a;var c;$.each(d,function(o,k){var f=k[1];var n=k[3];var u=k[4];var q=k[5];var e=k[6];var l=k[7];var s=k[8];var m=k[9];var p=k[10];var j=k[11];var r=k[12];if(!f){f="null"}var h=""+n+u;var i=""+q+e;var g=""+l+s;if(h!==b){var t=$("#pricing-table-template").html();$("#pricing-table").find("tr:last").before("<tr><td>"+t+"</td></tr>")}else{if(i!==a){var t=$("#pricing-table-template").find(".pricing-day-range").closest("table").closest("td").html();$("#pricing-table").find(".pricing-day-range:last").parents("tbody:eq(1)").find("tr:last").before("<tr><td>"+t+"</td></tr>")}else{if(g!==c){var t=$("#pricing-table-template").find(".pricing-time-range").closest("table").closest("td").html();$("#pricing-table").find(".pricing-time-range:last").parents("tbody:eq(1)").find("tr:last").before("<tr><td>"+t+"</td></tr>")}else{var t=$("#pricing-table-template").find(".pricing-price").html();$("#pricing-table").find(".pricing-price:last").parents("tbody:eq(1)").find("tr:last").before('<tr><td class="pricing-price">'+t+"</td></tr>")}}}if(m>=100){m=m.substring(0,m.length-2)+","+m.substring(m.length-2)}else{if(m>=10){m="0,"+m}else{m="0,0"+m}}$("#pricing-table .pricing-dateStart:last").val(n);$("#pricing-table .pricing-dateEnd:last").val(u);$("#pricing-table .pricing-dayStart:last").val(q);$("#pricing-table .pricing-dayEnd:last").val(e);$("#pricing-table .pricing-timeStart:last").val(l.substring(0,5));$("#pricing-table .pricing-timeEnd:last").val(s.substring(0,5));$("#pricing-table .pricing-price-number:last").val(m);$("#pricing-table .pricing-rate-gross:last").val(j);$("#pricing-table .pricing-rate:last").val(p);$("#pricing-table .pricing-sid:last").val(f);$("#pricing-table .pricing-timeBlock:last").val(Math.round(r/60));b=h;a=i;c=g});$(".datepicker").datepicker()})})();