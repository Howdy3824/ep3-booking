(function(){var f;var l;var d=false;var j;var a=300;var k=350;$(document).ready(function(){f=$(".calendar-table");f.on("click","a.calendar-cell",function(p){p.preventDefault();if(!l){p.stopPropagation();m($(this).attr("href"))}});$(window).resize(o);$("body").on("click","#squarebox-overlay",function(){i()});$("a.calendar-cell").hover(function(){var q=$(this);var p=q.attr("class");var r=p.match(/cc-group-\d+/);if(r){$("a."+r).css({opacity:0.9,"background-color":q.css("background-color")});q.css("opacity",1)}},function(){var q=$(this);var p=q.attr("class");var r=p.match(/cc-group-\d+/);if(r){$("a."+r).removeAttr("style")}});c();$(window).resize(c);$(document).on("updateLayout",c);e();$(window).resize(e);$(document).on("updateLayout",e);if($("body").height()<576){$(".content-panel").css("padding",30)}});function m(p){var q=$("#calendar-squarebox-template");if(q.length){b(q.html())}else{b('<div class="padded">...</p>')}l.clearQueue().delay(a).queue(function(){$.ajax({cache:false,data:{ajax:true},dataType:"html",error:function(){if(l&&!d){window.location.href=p}},success:function(r){if(l&&!d){b(r);l.find(".no-ajax").remove();l.find(".datepicker").datepicker();l.find(".inline-label-container").each(function(){updateInlineLabel($(this))});o();l.on("click","a.squarebox-internal-link",function(s){s.preventDefault();m($(this).attr("href"))});l.on("click","a.squarebox-close-link",function(s){s.preventDefault();i()})}},url:p});$(this).dequeue()})}function g(){if(!j){j=$('<div id="squarebox-overlay"></div>').css({position:"absolute","z-index":1532,opacity:0,width:$(document).width(),height:$(document).height(),left:0,top:0,background:"#333"});$("body").prepend(j)}if(!l){l=$('<div class="panel"></div>').css({position:"absolute","z-index":1536});$("body").prepend(l)}}function b(p){g();l.clearQueue();l.css("opacity",0.01);l.html(p);o();l.fadeTo(k,1);n()}function o(){if(l){var p;if($("body").height()>$(window).height()){p=window}else{p=f}l.position({my:"center",at:"center",of:p})}}function i(){if(l){d=true;l.clearQueue().fadeOut(k,function(){if(l){l.remove();l=undefined}d=false});h()}}function n(){if(j){j.clearQueue().fadeTo(k,0.75)}}function h(){if(j){j.clearQueue().fadeTo(k,0,function(){if(j){j.remove();j=undefined}})}}function c(){var q=$("#calendar").width();var p=$(".calendar-time-col, .calendar-square-col").width();var r=$(".calendar-date-col:visible");if(q&&p&&r.length){r.width(Math.floor((q-p)/r.length))}}function e(){$(".calendar-date-col").each(function(x){var B=$(this);var z=[];B.find(".cc-event").each(function(){var H=$(this).attr("class");var I=H.match(/cc-group-\d+/);if(I){if($.inArray(I,z)===-1){z.push(I)}}});var s=z.length;for(var C=0;C<=s;C++){var v=z[C];var E=B.find("."+v+":first");var A=B.find("."+v+":last");var G=E.position();var p=A.position();if(G&&p){var F=Math.round(G.left)-1;var D=Math.round(G.top)-1;var r=Math.round(p.left)+1;var q=Math.round(p.top)+1;var y=Math.round((r+A.width())-F);var w=Math.round((q+A.height())-D);var u=$("#"+v+"-overlay-"+x);if(!u.length){u=E.clone();u.appendTo(E.closest("td"));u.attr("id",v+"-overlay-"+x);u.attr("class","calendar-cell cc-event")}var t=u.find(".cc-label");u.css({position:"absolute","z-index":128,left:F,top:D,width:y,height:w});t.css({height:"auto","font-size":"12px","line-height":1.5});t.css({position:"relative",top:Math.round((w/2)-(t.height()/2))})}}})}})();